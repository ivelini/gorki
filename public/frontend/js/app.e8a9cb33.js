(function(){"use strict";var e={745:function(e,t,o){var s=o(963),r=o(252),i=o(577);const n={class:"container"},l={class:"header row"},a={class:"span12"},d={class:"navbar"},u={class:"navbar-inner"},c=(0,r._)("a",{class:"btn btn-navbar","data-toggle":"collapse","data-target":".nav-collapse"},[(0,r._)("span",{class:"icon-bar"}),(0,r._)("span",{class:"icon-bar"}),(0,r._)("span",{class:"icon-bar"})],-1),p={class:"nav-collapse collapse"},m={class:"nav pull-right"},h={key:0},v=(0,r._)("a",{href:"/register"},"Регистрация",-1),g=[v],f={key:1},_=(0,r._)("div",null,[(0,r._)("footer",null,[(0,r._)("div",{class:"container"},[(0,r._)("div",{class:"row"},[(0,r._)("div",{class:"copyright span4"},[(0,r._)("p",null,"Тестовое - RESTFull серис бронирования")])])])])],-1);function w(e,t,o,v,w,y){const k=(0,r.up)("router-link"),b=(0,r.up)("router-view");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",n,[(0,r._)("div",l,[(0,r._)("div",a,[(0,r._)("div",d,[(0,r._)("div",u,[c,(0,r._)("div",p,[(0,r._)("ul",m,[(0,r.wy)((0,r._)("li",null,[(0,r.Wm)(k,{to:{name:"home"}},{default:(0,r.w5)((()=>[(0,r.Uk)("Забронировать")])),_:1})],512),[[s.F8,this.$store.getters.getApiToken]]),this.$store.getters.getUser.name?((0,r.wg)(),(0,r.iD)("li",f,[(0,r._)("a",{onClick:t[0]||(t[0]=(...e)=>y.deleteToken&&y.deleteToken(...e)),style:{cursor:"pointer"}},(0,i.zw)(this.$store.getters.getUser.name)+" - Выход",1)])):((0,r.wg)(),(0,r.iD)("li",h,g))])])])])])])]),(0,r.wy)((0,r.Wm)(b,null,null,512),[[s.F8,this.$store.getters.getApiToken]]),_],64)}var y=o(907),k={mounted(){this.getToken(),null!=this.$store.getters.getApiToken&&this.getUser()},methods:{...(0,y.OI)(["registeredUser","updateToken"]),async getUser(){let e=await fetch(`${this.$store.getters.getApiDomain}/api/user`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.$store.getters.getApiToken}`}}),t=await e.json();this.$store.commit("registeredUser",t)},getToken(){let e=localStorage.getItem("token");null!=e&&this.$store.commit("updateToken",{token:e})},deleteToken(){localStorage.removeItem("token"),this.$store.commit("updateToken",{token:null}),window.location.href=this.$store.getters.getApiDomain}}},b=o(744);const $=(0,b.Z)(k,[["render",w]]);var R=$,A=o(201);const T=(0,r._)("h2",null,"Забронировать /",-1),D=(0,r._)("p",null,"Выбрать дату бронирования",-1),U={class:"contact-us container"},F={class:"row"},I={class:"contact-form span7"},O=(0,r._)("label",{for:"name",class:"nameLabel"},"Дата",-1),S=(0,r._)("input",{id:"date",type:"date"},null,-1),j={key:0,id:"userId",type:"text",placeholder:"ID пользователя"};function C(e,t,o,i,n,l){const a=(0,r.up)("header-content"),d=(0,r.up)("filter-component"),u=(0,r.up)("reserved-room-component");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(a,null,{default:(0,r.w5)((()=>[T,D])),_:1}),(0,r._)("div",U,[(0,r._)("div",F,[(0,r._)("div",I,[(0,r._)("div",null,[O,S,this.$store.getters.getUser.isAdmin?((0,r.wg)(),(0,r.iD)("input",j)):(0,r.kq)("",!0),(0,r._)("button",{type:"submit",onClick:t[0]||(t[0]=(0,s.iM)(((...e)=>l.sendReserv&&l.sendReserv(...e)),["prevent"]))},"Забронировать")])])])]),(0,r.wy)((0,r.Wm)(d,{onSetFilter:t[1]||(t[1]=e=>l.addFilter(e))},null,512),[[s.F8,this.$store.getters.getUser.isAdmin]]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.reservedRooms,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.id,room:e,onSetEdit:t[2]||(t[2]=e=>l.onSetEdit(e)),onSetDelete:t[3]||(t[3]=e=>l.deleteReservRoom(e))},null,8,["room"])))),128))])}const E={class:"page-title"},x={class:"container"},z={class:"row"},B={class:"span12"};function L(e,t){return(0,r.wg)(),(0,r.iD)("div",E,[(0,r._)("div",x,[(0,r._)("div",z,[(0,r._)("div",B,[(0,r.WI)(e.$slots,"default")])])])])}const q={},P=(0,b.Z)(q,[["render",L]]);var W=P;const Z={class:"call-to-action container"},H={class:"row"},K={class:"call-to-action-text span12"},M={class:"ca-text"},V={style:{color:"orange","font-weight":"bold"}},Y={style:{color:"green","font-weight":"bold"}},G={style:{color:"black","font-weight":"bold"}},J={style:{color:"gray","font-weight":"bold"}},N=["value"],Q=["value"],X=["checked"];function ee(e,t,o,n,l,a){return(0,r.wg)(),(0,r.iD)("div",Z,[(0,r._)("div",H,[(0,r._)("div",K,[(0,r._)("div",M,[(0,r._)("p",null,[(0,r._)("span",V,"ID: "+(0,i.zw)(o.room.id),1),(0,r.Uk)("; "),(0,r._)("span",Y,"Дата создания: "+(0,i.zw)(o.room.created_at),1),(0,r.Uk)("; "),(0,r._)("span",G,"Дата брони: "+(0,i.zw)(o.room.reserverd_at),1),(0,r.Uk)("; "),(0,r.wy)((0,r._)("span",{style:{color:"green","font-weight":"bold"}},"Пользователь: "+(0,i.zw)(o.room.user_name)+";",513),[[s.F8,o.room.user_name]]),(0,r._)("span",J,(0,i.zw)(o.room.appruvedStatus),1),(0,r.Uk)("; "),(0,r._)("a",{onClick:t[0]||(t[0]=(...e)=>a.showEdit&&a.showEdit(...e)),style:{cursor:"pointer",color:"#0e90d2","font-weight":"bold"}},"Редактировать; "),(0,r._)("a",{onClick:t[1]||(t[1]=e=>this.$emit("setDelete",o.room.id)),style:{cursor:"pointer",color:"red","font-weight":"bold"}},"Удалить")]),(0,r._)("p",{id:"editBlock",style:(0,i.j5)(l.editBlockStyle)},[(0,r._)("input",{type:"date",value:l.editRooms.date,onInput:t[2]||(t[2]=e=>l.editRooms.date=e.target.value)},null,40,N),this.$store.getters.getUser.isAdmin?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[(0,r._)("input",{type:"text",placeholder:"ID пользователя",value:l.editRooms.userId,onInput:t[3]||(t[3]=e=>l.editRooms.userId=e.target.value)},null,40,Q),(0,r.wy)((0,r._)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>l.editRooms.isAppruved=e),checked:l.editRooms.isAppruved},null,8,X),[[s.e8,l.editRooms.isAppruved]])],64)):(0,r.kq)("",!0),(0,r._)("button",{type:"submit",onClick:t[5]||(t[5]=(0,s.iM)(((...e)=>a.save&&a.save(...e)),["prevent"]))},"Сохранить")],4)])])])])}var te={props:["room"],emits:["setEdit","setDelete"],data(){return{editRooms:{date:null,userId:null,isAppruved:!1},editBlockStyle:{display:"none"}}},methods:{showEdit(){console.log(this.room),this.editBlockStyle.display="block",this.editRooms.date=this.room.reserverd_at,this.editRooms.userId=this.room.user_id,this.editRooms.id=this.room.id,this.editRooms.isAppruved=this.room.is_appruved},save(){this.$emit("setEdit",this.editRooms),this.editBlockStyle.display="none"}}};const oe=(0,b.Z)(te,[["render",ee]]);var se=oe;const re={class:"call-to-action container"},ie={class:"row"},ne={class:"call-to-action-text span12"},le={class:"ca-button"},ae={class:"ca-button"},de={class:"ca-button"},ue={class:"ca-button"},ce={class:"ca-button"};function pe(e,t,o,i,n,l){return(0,r.wg)(),(0,r.iD)("div",re,[(0,r._)("div",ie,[(0,r._)("div",ne,[(0,r._)("div",le,[(0,r._)("a",{onClick:t[0]||(t[0]=(...e)=>l.reset&&l.reset(...e)),style:{cursor:"pointer"}},"Сброс")]),(0,r._)("div",ae,[(0,r._)("a",{onClick:t[1]||(t[1]=e=>n.filter.is_appruved=0),style:{cursor:"pointer"}},"Не подтверждена")]),(0,r._)("div",de,[(0,r._)("a",{onClick:t[2]||(t[2]=e=>n.filter.is_appruved=1),style:{cursor:"pointer"}},"Подтверждена")]),(0,r._)("div",ue,[(0,r.wy)((0,r._)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>n.filter.limit=e),placeholder:"Количество"},null,512),[[s.nr,n.filter.limit]])]),(0,r._)("div",ce,[(0,r.wy)((0,r._)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>n.filter.user_id=e),placeholder:"ID пользователя"},null,512),[[s.nr,n.filter.user_id]])])])])])}var me={emits:["setFilter"],data(){return{filter:{user_id:null,limit:null,is_appruved:null},urlFilter:{}}},watch:{filter:{handler(e){for(let t in e)null!=e[t]?this.urlFilter[t]=e[t]:delete this.urlFilter[t];this.$emit("setFilter",this.urlFilter)},deep:!0}},methods:{reset(){for(let e in this.filter)this.filter[e]=null;for(let e in this.urlFilter)delete this.urlFilter[e]}}};const he=(0,b.Z)(me,[["render",pe]]);var ve=he,ge={components:{HeaderContent:W,ReservedRoomComponent:se,FilterComponent:ve},data(){return{reservedRooms:[]}},mounted(){null!=this.$store.getters.getApiToken&&this.getListReservedRooms()},methods:{async sendReserv(){let e=document.querySelector("#date"),t=document.querySelector("#userId");if(0===e.value.length)e.focus();else{let o=new FormData;o.append("date",e.value),null!=t&&t.value.length>=0?o.append("userId",t.value):o.append("userId",this.$store.getters.getUser.id);let s=await fetch(`${this.$store.getters.getApiDomain}/api/rooms`,{method:"POST",headers:{Authorization:`Bearer ${this.$store.getters.getApiToken}`},body:o}),r=await s.json();"OK"==r.status&&(e.value=null,null!=t&&(t.value=null),await this.getListReservedRooms())}},async getListReservedRooms(e=null){let t=`${this.$store.getters.getApiDomain}/api/rooms`;null!=e&&(t+=e);let o=await fetch(t,{method:"GET",headers:{Authorization:`Bearer ${this.$store.getters.getApiToken}`}});this.reservedRooms=await o.json()},async deleteReservRoom(e){let t=await fetch(`${this.$store.getters.getApiDomain}/api/rooms/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${this.$store.getters.getApiToken}`}}),o=await t.json();"OK"==o.status&&await this.getListReservedRooms()},async onSetEdit(e){let t=await fetch(`${this.$store.getters.getApiDomain}/api/rooms/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.$store.getters.getApiToken}`},body:JSON.stringify(e)}),o=await t.json();console.log(e),"OK"==o.status&&await this.getListReservedRooms()},addFilter(e){this.$router.replace({name:"home",query:e});let t="";for(let o in e)t+=`&${o}=${e[o]}`;t=t.replace("&","?"),this.getListReservedRooms(t)}}};const fe=(0,b.Z)(ge,[["render",C]]);var _e=fe;const we=[{path:"/",name:"home",component:_e}],ye=(0,A.p7)({history:(0,A.PO)("/"),routes:we});var ke=ye,be=(0,y.MT)({state:{user:{isAdmin:!1},api:{domain:"http://127.0.0.1:8000",token:null}},getters:{getUser(e){return e.user},getApiDomain(e){return e.api.domain},getApiToken(e){return e.api.token}},mutations:{registeredUser(e,t){"Administrator"==t.role?e.user.isAdmin=!0:e.user.isAdmin=!1,e.user.name=t.name,e.user.id=t.id},updateToken(e,t){e.api.token=t.token}},actions:{},modules:{}});(0,s.ri)(R).use(be).use(ke).mount("#app")}},t={};function o(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,s,r,i){if(!s){var n=1/0;for(u=0;u<e.length;u++){s=e[u][0],r=e[u][1],i=e[u][2];for(var l=!0,a=0;a<s.length;a++)(!1&i||n>=i)&&Object.keys(o.O).every((function(e){return o.O[e](s[a])}))?s.splice(a--,1):(l=!1,i<n&&(n=i));if(l){e.splice(u--,1);var d=r();void 0!==d&&(t=d)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[s,r,i]}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,i,n=s[0],l=s[1],a=s[2],d=0;if(n.some((function(t){return 0!==e[t]}))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(a)var u=a(o)}for(t&&t(s);d<n.length;d++)i=n[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(u)},s=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[998],(function(){return o(745)}));s=o.O(s)})();
//# sourceMappingURL=app.e8a9cb33.js.map